syntax = "proto3";

package api;

option go_package = "github.com/SplitStackServer/splitstack-grpc-api/api";
option java_package = "io.splitstack.api";
option java_multiple_files = true;
option java_outer_classname = "TenantProto";
option csharp_namespace = "SplitStackServer.Api";
option php_namespace = "SplitStackServer\\Api";
option php_metadata_namespace = "GPBMetadata\\SplitStackServer\\Api";

import "google/api/annotations.proto";
import "google/protobuf/timestamp.proto";
import "google/protobuf/empty.proto";
import "api/common.proto";
import "common/common.proto";

// TenantService is the service providing API methods for managing tenants.
service TenantService {
  // Create a new tenant.
  rpc CreateTenant(CreateTenantRequest) returns (CreateTenantResponse) {
    option (google.api.http) = {
      post : "/api/tenants"
      body : "*"
    };
  }

  // Get the tenant for the given ID.
  rpc GetTenant(GetTenantRequest) returns (GetTenantResponse) {
    option (google.api.http) = {
      get : "/api/tenants/{id}"
    };
  }

  // Update the given tenant.
  rpc UpdateTenant(UpdateTenantRequest) returns (UpdateTenantResponse) {
    option (google.api.http) = {
      put : "/api/tenants/{id}"
      body : "*"
    };
  }

  // Enable the given variable MAC for the tenant.
  rpc EnableVariableMac(EnableVariableMacRequest) returns (VariableMacResponse) {
    option (google.api.http) = {
      post : "/api/tenants/{id}/variable-mac/enable"
      body : "*"
    };
  }

  // Disable the given variable MAC for the tenant.
  rpc DisableVariableMac(DisableVariableMacRequest) returns (VariableMacResponse) {
    option (google.api.http) = {
      post : "/api/tenants/{id}/variable-mac/disable"
      body : "*"
    };
  }

  // Delete the tenant with the given ID.
  rpc DeleteTenant(DeleteTenantRequest) returns (google.protobuf.Empty) {
    option (google.api.http) = {
      delete : "/api/tenants/{id}"
    };
  }

  // Get the list of tenants.
  rpc ListTenants(ListTenantsRequest) returns (ListTenantsResponse) {
    option (google.api.http) = {
      get : "/api/tenants"
    };
  }
}

message Tenant {
  // Tenant ID (UUID).
  // Note: this value will be automatically generated on create.
  string id = 1;

  // Tenant name,
  string name = 2;

  // Tenant description.
  optional string description = 3;

  // Can the tenant create and "own" Gateways?
  bool can_have_basestations = 4;

  // Max. basestation count for tenant.
  // When set to 0, the tenant can have unlimited basestations.
  uint32 max_basestation_count = 5;

  // Max. device count for tenant.
  // When set to 0, the tenant can have unlimited devices.
  uint32 max_device_count = 6;

  // Private basestations.
  // If enabled, then basestations will not be shared with other tenants.
  bool private_basestations = 7;

  // Private devices.
  // If enabled, then devices will not be shared with other tenants and will not be attached to their basestations.
  bool private_devices = 8;

  // List of variable MACs enabled for the tenant.
  VariableMacList variable_mac_enabled = 9;

  // Tags (user defined).
  // These tags can be used to add additional information to the tenant. These
  // tags are NOT exposed in the integration events.
  optional common.Tags tags = 10;
}

message TenantListItem {
  // Tenant ID (UUID).
  string id = 1;

  // Created at timestamp.
  google.protobuf.Timestamp created_at = 2;

  // Last update timestamp.
  google.protobuf.Timestamp updated_at = 3;

  // Tenant name.
  string name = 4;

  // Can the tenant create and "own" Gateways?
  bool can_have_basestations = 5;

  // Private basestations.
  // If enabled, then basestations will not be shared with other tenants.
  bool private_basestations = 7;

  // Private devices.
  // If enabled, then devices will not be shared with other tenants and will not be attached to their basestations.
  bool private_devices = 8;

  // Max basestation count.
  // 0 = unlimited.
  uint32 max_basestation_count = 9;

  // Max device count.
  // 0 = unlimited.
  uint32 max_device_count = 10;
}

message CreateTenantRequest {
  // Tenant name,
  string name = 2;

  // Tenant description.
  optional string description = 3;

  // Can the tenant create and "own" Gateways?
  bool can_have_basestations = 4;

  // Max. basestation count for tenant.
  // When set to 0, the tenant can have unlimited basestations.
  uint32 max_basestation_count = 5;

  // Max. device count for tenant.
  // When set to 0, the tenant can have unlimited devices.
  uint32 max_device_count = 6;

  // Private basestations.
  // If enabled, then basestations will not be shared with other tenants.
  bool private_basestations = 7;

  // Private devices.
  // If enabled, then devices will not be shared with other tenants and will not be attached to their basestations.
  bool private_devices = 8;

  // List of variable MACs enabled for the tenant.
  VariableMacList variable_mac_enabled = 9;

  // Tags (user defined).
  // These tags can be used to add additional information to the tenant. These
  // tags are NOT exposed in the integration events.
  optional common.Tags tags = 10;
}

message CreateTenantResponse {
  // Tenant object.
  Tenant tenant = 1;

  // Created at timestamp.
  google.protobuf.Timestamp created_at = 2;
}

message GetTenantRequest {
  // Tenant ID.
  string id = 1;
}

message GetTenantResponse {
  // Tenant object.
  Tenant tenant = 1;

  // Created at timestamp.
  google.protobuf.Timestamp created_at = 2;

  // Last update timestamp.
  google.protobuf.Timestamp updated_at = 3;
}

message UpdateTenantRequest {
  // Tenant ID (UUID).
  string id = 1;

  // Tenant name,
  optional string name = 2;

  // Tenant description.
  optional string description = 3;

  // Can the tenant create and "own" Gateways?
  optional bool can_have_basestations = 4;

  // Max. basestation count for tenant.
  // When set to 0, the tenant can have unlimited basestations.
  optional uint32 max_basestation_count = 5;

  // Max. device count for tenant.
  // When set to 0, the tenant can have unlimited devices.
  optional uint32 max_device_count = 6;

  // Private basestations.
  // If enabled, then basestations will not be shared with other tenants.
  optional bool private_basestations = 7;

  // Private devices.
  // If enabled, then devices will not be shared with other tenants and will not be attached to their basestations.
  optional bool private_devices = 8;

  // Tags (user defined).
  // These tags can be used to add additional information to the tenant. These
  // tags are NOT exposed in the integration events.
  optional common.Tags tags = 9;
}

message UpdateTenantResponse {
  // Tenant object.
  Tenant tenant = 1;

  // Created at timestamp.
  google.protobuf.Timestamp created_at = 2;

  // Last update timestamp.
  google.protobuf.Timestamp updated_at = 3;
}

message EnableVariableMacRequest {
  // Tenant ID (UUID).
  string id = 1;

  // Variable MAC to enable for the tenant. See ETSI TS 103 357-2 Table 4-57
  uint32 vm = 2;
}

message DisableVariableMacRequest {
  // Tenant ID (UUID).
  string id = 1;

  // Variable MAC to disable for the tenant. See ETSI TS 103 357-2 Table 4-57
  uint32 vm = 2;
}

message VariableMacResponse {
  // Tenant ID (UUID).
  string id = 1;

  // List of variable MACs enabled for the tenant.
  VariableMacList vm = 2;
}



message DeleteTenantRequest {
  // Tenant ID.
  string id = 1;
}

message ListTenantsRequest {
  // Pagination. Defaults to 100 objects at page index 0.
  Paginator paginator = 1;

  // If set, the given string will be used to search on name.
  optional string search_name = 3;

  // If set, filters the result set to the tenants of the user.
  // This filter can only be used by admin users or global API keys.
  optional string user_id = 4;
}

message ListTenantsResponse {
  // Pagination.
  Pagination pagination = 1;

  // Result-set.
  repeated TenantListItem result = 2;
}
