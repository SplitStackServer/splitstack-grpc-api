syntax = "proto3";

package bs;

option go_package = "github.com/SplitStackServer/splitstack-grpc-api/go/bs";
option java_package = "io.splitstack.api.bs";
option java_multiple_files = true;
option java_outer_classname = "RspProto";
option csharp_namespace = "SplitStackServer.Basestation";
option php_namespace = "SplitStackServer\\Basestation";
option php_metadata_namespace = "GPBMetadata\\SplitStackServer\\Basestation";

message ServerResponse{
    // Basestation EUI, hex string
    string bs_eui = 1;
    // ID of the operation this response is for, used to match responses to requests
    // This is the same as the op_id in the request
    int64 op_id = 2;
    // Response ID (UUID)
    string response_id = 3;
    // Response.
    oneof response {
        // Server attachment
        EndnodeAttachSuccessResponse att_rsp = 4;
        // Server detachment
        EndnodeDetachSuccessResponse det_rsp = 5;
        // Server attachment error
        EndnodeAttachErrorResponse att_rsp_err = 6;
        // Server detachment error
        EndnodeDetachErrorResponse det_rsp_err = 7;
        // Error response
        ErrorResponse err = 8;
    };
}

message EndnodeAttachSuccessResponse{
    // Endnode EUI, hex string
    string endnode_eui = 1;

    // End Point short address, only if not assigned by the Base Station
    optional uint32 sh_addr = 2;

    // 16 Byte End Point network session key
    bytes nwk_session_key = 3;
}

message EndnodeAttachErrorResponse{
    // Endnode EUI, hex string
    string endnode_eui = 1;

    // Error message
    string message = 3;
}



message EndnodeDetachSuccessResponse{
    // Endnode EUI, hex string
    string endnode_eui = 1;

    // End Point signature, 4 bytes little endian
    uint32 sign = 2;
}

message EndnodeDetachErrorResponse{
    // Endnode EUI, hex string
    string endnode_eui = 1;

    // Error message
    string message = 3;
}


message ErrorResponse{
    // Error message
    string message = 1;

    // Error code
    uint32 code = 2;
}
